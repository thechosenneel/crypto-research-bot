<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Crypto Research Bot</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="container py-5">
  <h2 class="text-center mb-4">ðŸš€ Crypto Research Bot</h2>

  <form class="mb-4" method="GET" action="/">
    <input type="text" id="coin-search" class="form-control" placeholder="Search coin name..." autocomplete="off"/>
    <ul class="list-group" id="suggestions" style="position:absolute; z-index:1000;"></ul>
  </form>

  {% if error %}
    <div class="alert alert-danger">Error: {{ error }}</div>
  {% endif %}

  {% if coin %}
  <div class="card shadow p-4">
    <div class="d-flex align-items-center">
      <img src="{{ coin.image }}" width="50" class="me-3" />
      <h4>{{ coin.name }} ({{ coin.symbol.upper() }})</h4>
    </div>
    <hr/>
    <p><strong>Price:</strong> ${{ coin.price }}</p>
    <p><strong>24h Change:</strong> {{ coin.change_24h }}%</p>
    <p><strong>7d Change:</strong> {{ coin.change_7d }}%</p>
    <p><strong>Market Cap:</strong> ${{ "{:,.0f}".format(coin.market_cap) }}</p>
    <p><strong>Volume:</strong> ${{ "{:,.0f}".format(coin.volume) }}</p>
    <p><strong>Rank:</strong> {{ coin.rank }}</p>
    <p><strong>Volume / Cap Ratio:</strong> {{ coin.volume_to_cap }}</p>
    <p><strong>ATH Gap:</strong> {{ coin.ath_gap_percent }}%</p>
    <p><strong>Circulating Supply %:</strong> {{ coin.circ_supply_percent }}%</p>

    <canvas id="chart" height="100"></canvas>
    <script>
      const ctx = document.getElementById('chart').getContext('2d');
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: [...Array({{ coin.sparkline|length }}).keys()],
          datasets: [{
            label: '7 Day Price Trend',
            data: {{ coin.sparkline }},
            borderColor: '#0d6efd',
            fill: false,
            tension: 0.4
          }]
        },
        options: {
          plugins: { legend: { display: false } },
          scales: {
            x: { display: false },
            y: { display: false }
          }
        }
      });
    </script>
  </div>
  {% endif %}
</div>

<script src="/static/script.js"></script>
</body>
</html>
